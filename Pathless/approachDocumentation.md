The program fixes that any path from 1 to n accumulates at least the total array sum base. If s < base, Alice cannot win for any order, so it prints any arrangement. Otherwise, it tries to set the last two cells to values x and y so that any extra detours beyond the base sum necessarily add step = x + y each time via loops on the last edge, making s unreachable unless (s − base) is a multiple of step. If it finds such a tail with step not dividing (s − base), it outputs a permutation ending with x, y; otherwise it prints −1. This is a clean, fast heuristic based on concentrating detours at the last edge.